<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Expense Tracker</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Lucide React icons as inline SVG components
        const Camera = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"></path>
                <circle cx="12" cy="13" r="3"></circle>
            </svg>
        );

        const TrendingUp = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
                <polyline points="17 6 23 6 23 12"></polyline>
            </svg>
        );

        const Calendar = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                <line x1="16" y1="2" x2="16" y2="6"></line>
                <line x1="8" y1="2" x2="8" y2="6"></line>
                <line x1="3" y1="10" x2="21" y2="10"></line>
            </svg>
        );

        const DollarSign = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <line x1="12" y1="1" x2="12" y2="23"></line>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
            </svg>
        );

        const PieChart = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M21.21 15.89A10 10 0 1 1 8 2.83"></path>
                <path d="M22 12A10 10 0 0 0 12 2v10z"></path>
            </svg>
        );

        const Plus = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
        );

        const Trash2 = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <polyline points="3 6 5 6 21 6"></polyline>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                <line x1="10" y1="11" x2="10" y2="17"></line>
                <line x1="14" y1="11" x2="14" y2="17"></line>
            </svg>
        );

        const Edit2 = ({ size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                <path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path>
            </svg>
        );

        const CATEGORIES = [
            'Food', 'Groceries', 'Entertainment', 'Healthcare', 
            'Transport', 'Shopping', 'Bills', 'Fun', 'Other'
        ];

        const CATEGORY_COLORS = {
            'Food': '#FF6B6B',
            'Groceries': '#4ECDC4',
            'Entertainment': '#95E1D3',
            'Healthcare': '#F38181',
            'Transport': '#AA96DA',
            'Shopping': '#FCBAD3',
            'Bills': '#A8E6CF',
            'Fun': '#FFD93D',
            'Other': '#C7CEEA'
        };

        function ExpenseTracker() {
            const [expenses, setExpenses] = useState([]);
            const [view, setView] = useState('scan');
            const [timeframe, setTimeframe] = useState('monthly');
            const [editingId, setEditingId] = useState(null);
            const [newExpense, setNewExpense] = useState({
                amount: '',
                category: 'Food',
                description: '',
                date: new Date().toISOString().split('T')[0]
            });

            useEffect(() => {
                loadExpenses();
            }, []);

            const loadExpenses = () => {
                try {
                    const stored = localStorage.getItem('expenses');
                    if (stored) {
                        setExpenses(JSON.parse(stored));
                    }
                } catch (error) {
                    console.log('No existing expenses found');
                }
            };

            const saveExpenses = (updatedExpenses) => {
                try {
                    localStorage.setItem('expenses', JSON.stringify(updatedExpenses));
                    setExpenses(updatedExpenses);
                } catch (error) {
                    console.error('Failed to save expenses:', error);
                    alert('Failed to save data');
                }
            };

            const handleImageUpload = (e) => {
                const file = e.target.files[0];
                if (file) {
                    alert('Receipt image captured! Please enter the expense details below.');
                }
            };

            const addExpense = () => {
                if (!newExpense.amount || parseFloat(newExpense.amount) <= 0) {
                    alert('Please enter a valid amount');
                    return;
                }

                const expense = {
                    id: Date.now(),
                    amount: parseFloat(newExpense.amount),
                    category: newExpense.category,
                    description: newExpense.description,
                    date: newExpense.date,
                    timestamp: new Date(newExpense.date).getTime()
                };

                saveExpenses([...expenses, expense]);
                setNewExpense({
                    amount: '',
                    category: 'Food',
                    description: '',
                    date: new Date().toISOString().split('T')[0]
                });
            };

            const deleteExpense = (id) => {
                if (confirm('Delete this expense?')) {
                    saveExpenses(expenses.filter(e => e.id !== id));
                }
            };

            const updateExpense = (id, field, value) => {
                saveExpenses(expenses.map(e => 
                    e.id === id ? { ...e, [field]: value } : e
                ));
            };

            const getFilteredExpenses = () => {
                const now = new Date();
                const today = new Date(now.getFullYear(), now.getMonth(), now.getDate()).getTime();
                
                return expenses.filter(e => {
                    const expenseDate = new Date(e.date).getTime();
                    
                    switch(timeframe) {
                        case 'daily':
                            return expenseDate >= today;
                        case 'weekly':
                            const weekAgo = today - (7 * 24 * 60 * 60 * 1000);
                            return expenseDate >= weekAgo;
                        case 'monthly':
                            const monthAgo = today - (30 * 24 * 60 * 60 * 1000);
                            return expenseDate >= monthAgo;
                        case 'yearly':
                            const yearAgo = today - (365 * 24 * 60 * 60 * 1000);
                            return expenseDate >= yearAgo;
                        default:
                            return true;
                    }
                });
            };

            const getTotalByCategory = () => {
                const filtered = getFilteredExpenses();
                const totals = {};
                
                filtered.forEach(e => {
                    totals[e.category] = (totals[e.category] || 0) + e.amount;
                });
                
                return totals;
            };

            const getTotal = () => {
                return getFilteredExpenses().reduce((sum, e) => sum + e.amount, 0);
            };

            const renderScanView = () => (
                <div className="space-y-6">
                    <div className="bg-gradient-to-br from-blue-500 to-purple-600 rounded-2xl p-8 text-white text-center">
                        <div className="flex justify-center mb-4">
                            <Camera size={48} />
                        </div>
                        <h2 className="text-2xl font-bold mb-2">Scan Receipt</h2>
                        <p className="mb-6 opacity-90">Take a photo of your receipt</p>
                        <label className="bg-white text-blue-600 px-6 py-3 rounded-full font-semibold cursor-pointer hover:bg-blue-50 transition inline-block">
                            <input
                                type="file"
                                accept="image/*"
                                capture="environment"
                                onChange={handleImageUpload}
                                className="hidden"
                            />
                            Open Camera
                        </label>
                    </div>

                    <div className="bg-white rounded-2xl p-6 shadow-lg">
                        <h3 className="text-xl font-bold mb-4 flex items-center gap-2">
                            <Plus size={24} />
                            Add Expense Manually
                        </h3>
                        
                        <div className="space-y-4">
                            <div>
                                <label className="block text-sm font-medium mb-2">Amount ($)</label>
                                <input
                                    type="number"
                                    step="0.01"
                                    value={newExpense.amount}
                                    onChange={(e) => setNewExpense({...newExpense, amount: e.target.value})}
                                    className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 outline-none"
                                    placeholder="0.00"
                                />
                            </div>

                            <div>
                                <label className="block text-sm font-medium mb-2">Category</label>
                                <select
                                    value={newExpense.category}
                                    onChange={(e) => setNewExpense({...newExpense, category: e.target.value})}
                                    className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 outline-none"
                                >
                                    {CATEGORIES.map(cat => (
                                        <option key={cat} value={cat}>{cat}</option>
                                    ))}
                                </select>
                            </div>

                            <div>
                                <label className="block text-sm font-medium mb-2">Description</label>
                                <input
                                    type="text"
                                    value={newExpense.description}
                                    onChange={(e) => setNewExpense({...newExpense, description: e.target.value})}
                                    className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 outline-none"
                                    placeholder="What did you buy?"
                                />
                            </div>

                            <div>
                                <label className="block text-sm font-medium mb-2">Date</label>
                                <input
                                    type="date"
                                    value={newExpense.date}
                                    onChange={(e) => setNewExpense({...newExpense, date: e.target.value})}
                                    className="w-full p-3 border-2 border-gray-200 rounded-xl focus:border-blue-500 outline-none"
                                />
                            </div>

                            <button
                                onClick={addExpense}
                                className="w-full bg-blue-500 text-white py-3 rounded-xl font-semibold hover:bg-blue-600 transition"
                            >
                                Add Expense
                            </button>
                        </div>
                    </div>
                </div>
            );

            const renderStatsView = () => {
                const categoryTotals = getTotalByCategory();
                const total = getTotal();
                const sortedCategories = Object.entries(categoryTotals).sort((a, b) => b[1] - a[1]);

                return (
                    <div className="space-y-6">
                        <div className="flex gap-2 overflow-x-auto pb-2">
                            {['daily', 'weekly', 'monthly', 'yearly'].map(tf => (
                                <button
                                    key={tf}
                                    onClick={() => setTimeframe(tf)}
                                    className={`px-4 py-2 rounded-full font-semibold whitespace-nowrap transition ${
                                        timeframe === tf
                                            ? 'bg-blue-500 text-white'
                                            : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                                    }`}
                                >
                                    {tf.charAt(0).toUpperCase() + tf.slice(1)}
                                </button>
                            ))}
                        </div>

                        <div className="bg-gradient-to-br from-green-500 to-teal-600 rounded-2xl p-8 text-white">
                            <div className="flex items-center gap-3 mb-2">
                                <DollarSign size={32} />
                                <h3 className="text-lg opacity-90">Total Spending</h3>
                            </div>
                            <div className="text-5xl font-bold">${total.toFixed(2)}</div>
                            <div className="text-sm opacity-90 mt-2 capitalize">{timeframe} total</div>
                        </div>

                        <div className="bg-white rounded-2xl p-6 shadow-lg">
                            <h3 className="text-xl font-bold mb-4 flex items-center gap-2">
                                <PieChart size={24} />
                                Spending by Category
                            </h3>

                            <div className="space-y-3">
                                {sortedCategories.length === 0 ? (
                                    <p className="text-gray-500 text-center py-8">No expenses in this timeframe</p>
                                ) : (
                                    sortedCategories.map(([category, amount]) => {
                                        const percentage = (amount / total) * 100;
                                        return (
                                            <div key={category}>
                                                <div className="flex justify-between mb-1">
                                                    <span className="font-medium">{category}</span>
                                                    <span className="font-bold">${amount.toFixed(2)}</span>
                                                </div>
                                                <div className="w-full bg-gray-200 rounded-full h-3">
                                                    <div
                                                        className="h-3 rounded-full transition-all duration-500"
                                                        style={{
                                                            width: `${percentage}%`,
                                                            backgroundColor: CATEGORY_COLORS[category]
                                                        }}
                                                    />
                                                </div>
                                                <div className="text-sm text-gray-500 mt-1">{percentage.toFixed(1)}%</div>
                                            </div>
                                        );
                                    })
                                )}
                            </div>
                        </div>
                    </div>
                );
            };

            const renderHistoryView = () => {
                const filtered = getFilteredExpenses().sort((a, b) => b.timestamp - a.timestamp);

                return (
                    <div className="space-y-4">
                        <div className="flex gap-2 overflow-x-auto pb-2">
                            {['daily', 'weekly', 'monthly', 'yearly'].map(tf => (
                                <button
                                    key={tf}
                                    onClick={() => setTimeframe(tf)}
                                    className={`px-4 py-2 rounded-full font-semibold whitespace-nowrap transition ${
                                        timeframe === tf
                                            ? 'bg-blue-500 text-white'
                                            : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                                    }`}
                                >
                                    {tf.charAt(0).toUpperCase() + tf.slice(1)}
                                </button>
                            ))}
                        </div>

                        {filtered.length === 0 ? (
                            <div className="bg-white rounded-2xl p-12 text-center shadow-lg">
                                <div className="flex justify-center mb-4">
                                    <Calendar size={48} className="text-gray-300" />
                                </div>
                                <p className="text-gray-500">No expenses in this timeframe</p>
                            </div>
                        ) : (
                            filtered.map(expense => (
                                <div key={expense.id} className="bg-white rounded-xl p-4 shadow-lg">
                                    {editingId === expense.id ? (
                                        <div className="space-y-3">
                                            <input
                                                type="number"
                                                step="0.01"
                                                defaultValue={expense.amount}
                                                onBlur={(e) => updateExpense(expense.id, 'amount', parseFloat(e.target.value))}
                                                className="w-full p-2 border-2 border-gray-200 rounded-lg"
                                            />
                                            <select
                                                defaultValue={expense.category}
                                                onChange={(e) => updateExpense(expense.id, 'category', e.target.value)}
                                                className="w-full p-2 border-2 border-gray-200 rounded-lg"
                                            >
                                                {CATEGORIES.map(cat => (
                                                    <option key={cat} value={cat}>{cat}</option>
                                                ))}
                                            </select>
                                            <input
                                                type="text"
                                                defaultValue={expense.description}
                                                onBlur={(e) => updateExpense(expense.id, 'description', e.target.value)}
                                                className="w-full p-2 border-2 border-gray-200 rounded-lg"
                                            />
                                            <button
                                                onClick={() => setEditingId(null)}
                                                className="w-full bg-gray-500 text-white py-2 rounded-lg"
                                            >
                                                Done
                                            </button>
                                        </div>
                                    ) : (
                                        <>
                                            <div className="flex justify-between items-start mb-2">
                                                <div className="flex-1">
                                                    <div className="flex items-center gap-2 mb-1">
                                                        <span
                                                            className="px-3 py-1 rounded-full text-sm font-semibold text-white"
                                                            style={{ backgroundColor: CATEGORY_COLORS[expense.category] }}
                                                        >
                                                            {expense.category}
                                                        </span>
                                                    </div>
                                                    <div className="text-2xl font-bold text-gray-900">
                                                        ${expense.amount.toFixed(2)}
                                                    </div>
                                                    {expense.description && (
                                                        <div className="text-gray-600 mt-1">{expense.description}</div>
                                                    )}
                                                    <div className="text-sm text-gray-400 mt-1">{expense.date}</div>
                                                </div>
                                                <div className="flex gap-2">
                                                    <button
                                                        onClick={() => setEditingId(expense.id)}
                                                        className="p-2 hover:bg-blue-50 rounded-lg transition"
                                                    >
                                                        <Edit2 size={20} className="text-blue-500" />
                                                    </button>
                                                    <button
                                                        onClick={() => deleteExpense(expense.id)}
                                                        className="p-2 hover:bg-red-50 rounded-lg transition"
                                                    >
                                                        <Trash2 size={20} className="text-red-500" />
                                                    </button>
                                                </div>
                                            </div>
                                        </>
                                    )}
                                </div>
                            ))
                        )}
                    </div>
                );
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 p-4">
                    <div className="max-w-2xl mx-auto">
                        <div className="text-center mb-6 pt-4">
                            <h1 className="text-4xl font-bold text-gray-900 mb-2">ðŸ’° Expense Tracker</h1>
                            <p className="text-gray-600">Track your spending with ease</p>
                        </div>

                        <div className="flex gap-2 mb-6 bg-white rounded-2xl p-2 shadow-lg">
                            <button
                                onClick={() => setView('scan')}
                                className={`flex-1 py-3 rounded-xl font-semibold transition flex items-center justify-center gap-2 ${
                                    view === 'scan'
                                        ? 'bg-blue-500 text-white'
                                        : 'text-gray-600 hover:bg-gray-50'
                                }`}
                            >
                                <Camera size={20} />
                                Add
                            </button>
                            <button
                                onClick={() => setView('stats')}
                                className={`flex-1 py-3 rounded-xl font-semibold transition flex items-center justify-center gap-2 ${
                                    view === 'stats'
                                        ? 'bg-blue-500 text-white'
                                        : 'text-gray-600 hover:bg-gray-50'
                                }`}
                            >
                                <TrendingUp size={20} />
                                Stats
                            </button>
                            <button
                                onClick={() => setView('history')}
                                className={`flex-1 py-3 rounded-xl font-semibold transition flex items-center justify-center gap-2 ${
                                    view === 'history'
                                        ? 'bg-blue-500 text-white'
                                        : 'text-gray-600 hover:bg-gray-50'
                                }`}
                            >
                                <Calendar size={20} />
                                History
                            </button>
                        </div>

                        {view === 'scan' && renderScanView()}
                        {view === 'stats' && renderStatsView()}
                        {view === 'history' && renderHistoryView()}
                    </div>
                </div>
            );
        }

        ReactDOM.render(<ExpenseTracker />, document.getElementById('root'));
    </script>
</body>
</html>
